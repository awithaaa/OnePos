generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int     @id @default(autoincrement())
  firstName    String
  lastName     String
  email    String  @unique
  password String
  role     String  @default("cashier")
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt
  refreshTokens RefreshToken[]

  Sale Sale[]
}

model RefreshToken {
  id         Int      @id @default(autoincrement())
  tokenHash  String
  user       User     @relation(fields: [userId], references: [id])
  userId     Int
  createdAt  DateTime @default(now())
  expiresAt  DateTime
}

model Item {
  id      Int @id @default(autoincrement())
  name    String
  brand   String?
  suk     String? @unique
  discount   Decimal?  @db.Decimal(10,2)
  price   Decimal  @db.Decimal(10,2)
  salePrice   Decimal  @db.Decimal(10,2)
 
  SaleItem SaleItem[]
  Inventory Inventory[]
  EmptyInventory EmptyInventory[]
}

model Inventory {
  id         Int @id @default(autoincrement())
  itemId     Int
  quantity   Int
  stock      Int?
  price      Decimal  @db.Decimal(10,2)
  salePrice  Decimal  @db.Decimal(10,2)
  createdAt  DateTime       @default(now())
  updatedAt  DateTime       @updatedAt

  item       Item    @relation(fields: [itemId], references: [id])
}

model EmptyInventory {
  id         Int @id @default(autoincrement())
  itemId     Int
  quantity   Int
  stock      Int?
  price      Decimal  @db.Decimal(10,2)
  salePrice  Decimal  @db.Decimal(10,2)
  createdAt  DateTime       
  updatedAt  DateTime       @updatedAt

  item       Item    @relation(fields: [itemId], references: [id])
}

model Sale {
  id        Int     @id @default(autoincrement())
  userId    Int
  total     Decimal    @db.Decimal(10,2)
  createdAt DateTime   @default(now())
  saleItems SaleItem[]

  user      User       @relation(fields: [userId], references: [id])
}

model SaleItem {
  id       Int  @id @default(autoincrement())
  saleId   Int
  itemId   Int
  quantity Int
  price    Decimal @db.Decimal(10,2)

  item     Item    @relation(fields: [itemId], references: [id])
  sale     Sale    @relation(fields: [saleId], references: [id])
}